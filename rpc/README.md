This can be extracted to an RPC client lib
